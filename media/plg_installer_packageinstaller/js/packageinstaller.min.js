Joomla=window.Joomla||{},function(a){'use strict';document.addEventListener("DOMContentLoaded",function(){function b(b){d.setAttribute("data-state","pending");var c=a.Text._("PLG_INSTALLER_PACKAGEINSTALLER_UPLOAD_ERROR_UNKNOWN");null==b?c=a.Text._("PLG_INSTALLER_PACKAGEINSTALLER_UPLOAD_ERROR_EMPTY"):"string"==typeof b?c=b.replace(/(<([^>]+)>|\s+)/g," "):b.message&&(c=b.message),a.renderMessages({error:[c]})}if(a.submitbuttonpackage=function(){var b=document.getElementById("adminForm");if(""===b.install_package.value)a.renderMessages({warning:[a.Text._("PLG_INSTALLER_PACKAGEINSTALLER_NO_PACKAGE")]});else if(b.install_package.files[0].size>b.max_upload_size.value)a.renderMessages({warning:[a.Text._("COM_INSTALLER_MSG_WARNINGS_UPLOADFILETOOBIG")]});else{var c=document.getElementById("loading");c&&c.classList.remove("hidden"),b.installtype.value="upload",b.submit()}},"undefined"==typeof FormData)return document.querySelector("#legacy-uploader").classList.remove("hidden"),void document.querySelector("#uploader-wrapper").classList.add("hidden");var c=!1,d=document.querySelector("#dragarea"),e=document.querySelector("#install_package"),f=document.querySelector("#max_upload_size").value,g=document.querySelector("#select-file-button"),h=document.querySelector("#installer-return").value,i=document.getElementById("upload-progress"),j=i.querySelectorAll(".bar")[0],k=i.querySelectorAll(".uploading-number")[0],l="index.php?option=com_installer&task=install.ajax_upload";h&&(l+="&return=".concat(h)),g.addEventListener("click",function(){e.click()}),e.addEventListener("change",function(){c||a.submitbuttonpackage()}),d.addEventListener("dragenter",function(a){return a.preventDefault(),a.stopPropagation(),d.classList.add("hover"),!1}),d.addEventListener("dragover",function(a){return a.preventDefault(),a.stopPropagation(),d.classList.add("hover"),!1}),d.addEventListener("dragleave",function(a){return a.preventDefault(),a.stopPropagation(),d.classList.remove("hover"),!1}),d.addEventListener("drop",function(e){if(e.preventDefault(),e.stopPropagation(),!c){d.classList.remove("hover");var g=e.target.files||e.dataTransfer.files;if(g.length){var h=g[0],i=new FormData;if(h.size>f)return void a.renderMessages({warning:[a.Text._("COM_INSTALLER_MSG_WARNINGS_UPLOADFILETOOBIG")]});i.append("install_package",h),i.append("installtype","upload"),d.setAttribute("data-state","uploading"),j.setAttribute("aria-valuenow",0),c=!0,j.style.width=0,k.textContent="0";var m=function(a){if(a.lengthComputable){var b=a.loaded/a.total,c=Math.round(100*b);j.css("width","".concat(c,"%")),j.setAttribute("aria-valuenow",c),k.textContent="".concat(c),100===c&&d.setAttribute("data-state","installing")}};a.request({url:l,method:"POST",perform:!0,data:i,headers:{"Content-Type":"false"},uploadProgressCallback:m,onSuccess:function onSuccess(a){if(!a)return void b(a);var c;try{c=JSON.parse(a)}catch(a){return void b(a)}return c.success||c.data?void(c.data.redirect?window.location.href=c.data.redirect:window.location.href="index.php?option=com_installer&view=install"):void b(c)},onError:function onError(a){if(c=!1,200===a.status){var d=a.responseText||a.responseJSON;b(d)}else b(a.statusText)}})}}}),document.getElementById("installbutton_package").addEventListener("click",function(b){b.preventDefault(),a.submitbuttonpackage()})})}(Joomla);