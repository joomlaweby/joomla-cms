Joomla=window.Joomla||{},(a=>{'use strict';document.addEventListener("DOMContentLoaded",()=>{function b(b){d.setAttribute("data-state","pending");let c=a.Text._("PLG_INSTALLER_PACKAGEINSTALLER_UPLOAD_ERROR_UNKNOWN");null==b?c=a.Text._("PLG_INSTALLER_PACKAGEINSTALLER_UPLOAD_ERROR_EMPTY"):"string"==typeof b?c=b.replace(/(<([^>]+)>|\s+)/g," "):b.message&&({message:c}=b),a.renderMessages({error:[c]})}if(a.submitbuttonpackage=()=>{const b=document.getElementById("adminForm");if(""===b.install_package.value)a.renderMessages({warning:[a.Text._("PLG_INSTALLER_PACKAGEINSTALLER_NO_PACKAGE")]});else if(b.install_package.files[0].size>b.max_upload_size.value)a.renderMessages({warning:[a.Text._("COM_INSTALLER_MSG_WARNINGS_UPLOADFILETOOBIG")]});else{const a=document.getElementById("loading");a&&a.classList.remove("hidden"),b.installtype.value="upload",b.submit()}},"undefined"==typeof FormData)return document.querySelector("#legacy-uploader").classList.remove("hidden"),void document.querySelector("#uploader-wrapper").classList.add("hidden");let c=!1;const d=document.querySelector("#dragarea"),e=document.querySelector("#install_package"),f=document.querySelector("#max_upload_size").value,g=document.querySelector("#select-file-button"),h=document.querySelector("#installer-return").value,i=document.getElementById("upload-progress"),j=i.querySelectorAll(".bar")[0],k=i.querySelectorAll(".uploading-number")[0];let l="index.php?option=com_installer&task=install.ajax_upload";h&&(l+=`&return=${h}`),g.addEventListener("click",()=>{e.click()}),e.addEventListener("change",()=>{c||a.submitbuttonpackage()}),d.addEventListener("dragenter",a=>(a.preventDefault(),a.stopPropagation(),d.classList.add("hover"),!1)),d.addEventListener("dragover",a=>(a.preventDefault(),a.stopPropagation(),d.classList.add("hover"),!1)),d.addEventListener("dragleave",a=>(a.preventDefault(),a.stopPropagation(),d.classList.remove("hover"),!1)),d.addEventListener("drop",e=>{if(e.preventDefault(),e.stopPropagation(),c)return;d.classList.remove("hover");const g=e.target.files||e.dataTransfer.files;if(!g.length)return;const h=g[0],i=new FormData;if(h.size>f)return void a.renderMessages({warning:[a.Text._("COM_INSTALLER_MSG_WARNINGS_UPLOADFILETOOBIG")]});i.append("install_package",h),i.append("installtype","upload"),d.setAttribute("data-state","uploading"),j.setAttribute("aria-valuenow",0),c=!0,j.style.width=0,k.textContent="0";a.request({url:l,method:"POST",perform:!0,data:i,headers:{"Content-Type":"false"},uploadProgressCallback:a=>{if(a.lengthComputable){const b=a.loaded/a.total,c=Math.round(100*b);j.css("width",`${c}%`),j.setAttribute("aria-valuenow",c),k.textContent=`${c}`,100===c&&d.setAttribute("data-state","installing")}},onSuccess:a=>{if(!a)return void b(a);let c;try{c=JSON.parse(a)}catch(a){return void b(a)}return c.success||c.data?void(c.data.redirect?window.location.href=c.data.redirect:window.location.href="index.php?option=com_installer&view=install"):void b(c)},onError:a=>{if(c=!1,200===a.status){const c=a.responseText||a.responseJSON;b(c)}else b(a.statusText)}})}),document.getElementById("installbutton_package").addEventListener("click",b=>{b.preventDefault(),a.submitbuttonpackage()})})})(Joomla);